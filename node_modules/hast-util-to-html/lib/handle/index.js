/**
<<<<<<< HEAD
 * @typedef {import('../types.js').State} State
 * @typedef {import('../types.js').Node} Node
 * @typedef {import('../types.js').Parent} Parent
=======
 * @import {Nodes, Parents} from 'hast'
 * @import {State} from '../index.js'
>>>>>>> 08f40ceb (Initial)
 */

import {zwitch} from 'zwitch'
import {comment} from './comment.js'
import {doctype} from './doctype.js'
import {element} from './element.js'
import {raw} from './raw.js'
import {root} from './root.js'
import {text} from './text.js'

/**
<<<<<<< HEAD
 * @type {(node: Node, index: number | undefined, parent: Parent | undefined, state: State) => string}
=======
 * @type {(node: Nodes, index: number | undefined, parent: Parents | undefined, state: State) => string}
>>>>>>> 08f40ceb (Initial)
 */
export const handle = zwitch('type', {
  invalid,
  unknown,
  handlers: {comment, doctype, element, raw, root, text}
})

/**
 * Fail when a non-node is found in the tree.
 *
 * @param {unknown} node
 *   Unknown value.
 * @returns {never}
 *   Never.
 */
function invalid(node) {
  throw new Error('Expected node, not `' + node + '`')
}

/**
 * Fail when a node with an unknown type is found in the tree.
 *
<<<<<<< HEAD
 * @param {unknown} node
=======
 * @param {unknown} node_
>>>>>>> 08f40ceb (Initial)
 *  Unknown node.
 * @returns {never}
 *   Never.
 */
<<<<<<< HEAD
function unknown(node) {
  // @ts-expect-error: `type` is defined.
=======
function unknown(node_) {
  // `type` is guaranteed by runtime JS.
  const node = /** @type {Nodes} */ (node_)
>>>>>>> 08f40ceb (Initial)
  throw new Error('Cannot compile unknown node `' + node.type + '`')
}
