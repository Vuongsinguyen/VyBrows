<<<<<<< HEAD
import { build } from "esbuild";
async function buildClientDirectiveEntrypoint(name, entrypoint) {
  var _a;
=======
import { fileURLToPath } from "node:url";
import { build } from "esbuild";
async function buildClientDirectiveEntrypoint(name, entrypoint, root) {
>>>>>>> 08f40ceb (Initial)
  const stringifiedName = JSON.stringify(name);
  const stringifiedEntrypoint = JSON.stringify(entrypoint);
  const output = await build({
    stdin: {
      contents: `import directive from ${stringifiedEntrypoint};

(self.Astro || (self.Astro = {}))[${stringifiedName}] = directive;

window.dispatchEvent(new Event('astro:' + ${stringifiedName}));`,
<<<<<<< HEAD
      resolveDir: process.cwd()
    },
    absWorkingDir: process.cwd(),
=======
      resolveDir: fileURLToPath(root)
    },
    absWorkingDir: fileURLToPath(root),
>>>>>>> 08f40ceb (Initial)
    format: "iife",
    minify: true,
    bundle: true,
    write: false
  });
<<<<<<< HEAD
  const outputFile = (_a = output.outputFiles) == null ? void 0 : _a[0];
  if (!outputFile)
    return "";
=======
  const outputFile = output.outputFiles?.[0];
  if (!outputFile) return "";
>>>>>>> 08f40ceb (Initial)
  return outputFile.text;
}
export {
  buildClientDirectiveEntrypoint
};
