---
import '/src/styles/color.css';
import '/src/styles/global.css';
import NewsLayout from '../../../layouts/NewsLayout.astro';
import trainingData from '../../../data/trainingLoader.js';

export const prerender = true;

export async function getStaticPaths() {
  const languages = ['vi', 'ja', 'es', 'ko'];
  const paths: any[] = [];
  
  languages.forEach(lang => {
    trainingData.forEach(training => {
      paths.push({
        params: { lang, slug: training.slug }
      });
    });
  });
  
  return paths;
}

const { lang, slug: trainingSlug } = Astro.params;

// Create training titles for sidebar
const trainingTitles = trainingData.reduce((acc, training) => {
  acc[training.slug] = (training.title as any)[lang] || training.title.en;
  return acc;
}, {} as Record<string, string>);

// Language-specific text
const translations = {
  vi: {
    home: 'Trang chá»§',
    training: 'ÄÃ o táº¡o',
    professionalTraining: 'ChÆ°Æ¡ng trÃ¬nh Ä‘Ã o táº¡o chuyÃªn nghiá»‡p',
    curriculum: 'ChÆ°Æ¡ng trÃ¬nh há»c',
    whatsIncluded: 'Bao gá»“m',
    whyChooseUs: 'Táº¡i sao chá»n chÃºng tÃ´i?',
    exploreMore: 'KhÃ¡m phÃ¡ thÃªm cÃ¡c chÆ°Æ¡ng trÃ¬nh Ä‘Ã o táº¡o',
    learnMore: 'TÃ¬m hiá»ƒu thÃªm',
    readyToStart: 'Sáºµn sÃ ng báº¯t Ä‘áº§u hÃ nh trÃ¬nh?',
    readyDescription: 'LiÃªn há»‡ vá»›i chÃºng tÃ´i ngay hÃ´m nay Ä‘á»ƒ Ä‘Äƒng kÃ½ khÃ³a há»c nÃ y vÃ  nháº­n tÆ° váº¥n chi tiáº¿t.',
    contactNow: 'LiÃªn há»‡ ngay',
    contactUs: 'LiÃªn há»‡ vá»›i chÃºng tÃ´i',
    name: 'Há» tÃªn',
    email: 'Email',
    optional: '(TÃ¹y chá»n)',
    phone: 'Sá»‘ Ä‘iá»‡n thoáº¡i',
    message: 'Tin nháº¯n',
    messagePlaceholder: 'Cho chÃºng tÃ´i biáº¿t vá» má»¥c tiÃªu Ä‘Ã o táº¡o cá»§a báº¡n...',
    sendMessage: 'Gá»­i tin nháº¯n'
  },
  ja: {
    home: 'ãƒ›ãƒ¼ãƒ ',
    training: 'ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°',
    professionalTraining: 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ—ãƒ­ã‚°ãƒ©ãƒ ',
    curriculum: 'ã‚«ãƒªã‚­ãƒ¥ãƒ©ãƒ ',
    whatsIncluded: 'å«ã¾ã‚Œã‚‹ã‚‚ã®',
    whyChooseUs: 'é¸ã°ã‚Œã‚‹ç†ç”±',
    exploreMore: 'ãã®ä»–ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ¢ã™',
    learnMore: 'è©³ç´°ã‚’è¦‹ã‚‹',
    readyToStart: 'å§‹ã‚ã‚‹æº–å‚™ã¯ã§ãã¾ã—ãŸã‹ï¼Ÿ',
    readyDescription: 'ä»Šã™ããŠå•ã„åˆã‚ã›ã„ãŸã ãã€ã“ã®ã‚³ãƒ¼ã‚¹ã«ç™»éŒ²ã—ã¦è©³ç´°ãªç›¸è«‡ã‚’å—ã‘ã¦ãã ã•ã„ã€‚',
    contactNow: 'ãŠå•ã„åˆã‚ã›',
    contactUs: 'ãŠå•ã„åˆã‚ã›',
    name: 'ãŠåå‰',
    email: 'ãƒ¡ãƒ¼ãƒ«',
    optional: 'ï¼ˆä»»æ„ï¼‰',
    phone: 'é›»è©±ç•ªå·',
    message: 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
    messagePlaceholder: 'ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®ç›®æ¨™ã«ã¤ã„ã¦ãŠèã‹ã›ãã ã•ã„...',
    sendMessage: 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡'
  },
  es: {
    home: 'Inicio',
    training: 'CapacitaciÃ³n',
    professionalTraining: 'Programa de capacitaciÃ³n profesional',
    curriculum: 'Plan de estudios',
    whatsIncluded: 'QuÃ© incluye',
    whyChooseUs: 'Â¿Por quÃ© elegirnos?',
    exploreMore: 'Explorar mÃ¡s programas de capacitaciÃ³n',
    learnMore: 'MÃ¡s informaciÃ³n',
    readyToStart: 'Â¿Listo para comenzar tu viaje?',
    readyDescription: 'ContÃ¡ctenos hoy para inscribirse en este curso y recibir una consulta detallada.',
    contactNow: 'ContÃ¡ctenos ahora',
    contactUs: 'ContÃ¡ctenos',
    name: 'Nombre',
    email: 'Correo electrÃ³nico',
    optional: '(Opcional)',
    phone: 'TelÃ©fono',
    message: 'Mensaje',
    messagePlaceholder: 'CuÃ©ntanos sobre tus objetivos de capacitaciÃ³n...',
    sendMessage: 'Enviar mensaje'
  },
  ko: {
    home: 'í™ˆ',
    training: 'êµìœ¡',
    professionalTraining: 'ì „ë¬¸ êµìœ¡ í”„ë¡œê·¸ë¨',
    curriculum: 'ì»¤ë¦¬í˜ëŸ¼',
    whatsIncluded: 'í¬í•¨ ì‚¬í•­',
    whyChooseUs: 'ì„ íƒí•´ì•¼ í•˜ëŠ” ì´ìœ ',
    exploreMore: 'ë” ë§ì€ êµìœ¡ í”„ë¡œê·¸ë¨ íƒìƒ‰',
    learnMore: 'ìì„¸íˆ ë³´ê¸°',
    readyToStart: 'ì‹œì‘í•  ì¤€ë¹„ê°€ ë˜ì…¨ë‚˜ìš”?',
    readyDescription: 'ì˜¤ëŠ˜ ì €í¬ì—ê²Œ ì—°ë½í•˜ì—¬ ì´ ê³¼ì •ì— ë“±ë¡í•˜ê³  ìì„¸í•œ ìƒë‹´ì„ ë°›ìœ¼ì„¸ìš”.',
    contactNow: 'ì§€ê¸ˆ ë¬¸ì˜í•˜ê¸°',
    contactUs: 'ë¬¸ì˜í•˜ê¸°',
    name: 'ì´ë¦„',
    email: 'ì´ë©”ì¼',
    optional: '(ì„ íƒì‚¬í•­)',
    phone: 'ì „í™”ë²ˆí˜¸',
    message: 'ë©”ì‹œì§€',
    messagePlaceholder: 'êµìœ¡ ëª©í‘œì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”...',
    sendMessage: 'ë©”ì‹œì§€ ë³´ë‚´ê¸°'
  }
};

const t = (translations as any)[lang] || translations.vi;
---

<NewsLayout title={trainingTitles[trainingSlug] || t.training}>
  <!-- Hero Header Section - Services Style -->
  <section class="relative bg-gradient-to-b from-[var(--color-primary-dark)] to-black pb-12 pt-60">
    <div class="max-w-[1280px] mx-auto px-4 relative z-10 flex flex-col items-center text-left pt-16">
      <!-- Dynamic Heading -->
      <h1 class="text-4xl md:text-5xl font-bold mb-8 text-white text-center" style="font-family: 'Montserrat', sans-serif;">{trainingTitles[trainingSlug] || t.training}</h1>
      <p class="text-xl text-white/90 max-w-2xl mx-auto text-center mb-8">
        {t.professionalTraining}
      </p>
    </div>
    <!-- SVG Wave -->
    <div class="absolute inset-0 w-full h-full pointer-events-none select-none">
      <svg class="absolute bottom-0 left-0 w-full h-40" viewBox="0 0 1440 320" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill="var(--color-primary-dark)" fill-opacity="1" d="M0,288L80,272C160,256,320,224,480,197.3C640,171,800,149,960,154.7C1120,160,1280,192,1360,208L1440,224L1440,320L1360,320C1280,320,1120,320,960,320C800,320,640,320,480,320C320,320,160,320,80,320L0,320Z"/>
      </svg>
    </div>
  </section>
  <!-- Breadcrumb -->
  <div class="bg-gray-100">
    <div class="max-w-7xl mx-auto px-6 py-3">
      <nav class="flex items-center text-sm text-gray-600">
        <a href={`/${lang}`} class="hover:text-primary transition-colors">{t.home}</a>
        <svg class="w-4 h-4 mx-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
        <a href={`/${lang}/training`} class="hover:text-primary transition-colors">{t.training}</a>
        <svg class="w-4 h-4 mx-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
        <span class="text-gray-900 font-medium">{trainingTitles[trainingSlug]}</span>
      </nav>
    </div>
  </div>

  <div class="w-full bg-surface flex justify-center">
    <div class="w-full max-w-7xl bg-surface flex flex-col lg:flex-row gap-6 items-start px-6 py-8">
      <!-- Left Sidebar -->
      <aside class="w-full lg:w-64 bg-surface rounded-lg lg:mt-0 lg:sticky lg:top-32 z-20 order-1">
        <ul class="rounded-lg overflow-hidden flex flex-col">
          {trainingData.map((training, index) => (
            <li>
              <a 
                href={`/${lang}/training/${training.slug}`} 
                class={`block rounded-none px-3 py-2 font-normal transition-colors flex items-center gap-2 ${training.slug === trainingSlug ? 'font-semibold' : 'hover:text-primary'}`}
                style={training.slug === trainingSlug ? 'color: var(--color-primary);' : 'color: rgba(0, 0, 0, 0.7);'}
              >
                <img src="/images/diamond.svg" alt="" class="w-8 h-8 flex-shrink-0" />
                <span>{(training.title as any)[lang] || training.title.en}</span>
              </a>
            </li>
          ))}
        </ul>
      </aside>

      <!-- Main Content -->
      <main class="flex-1 space-y-12 order-2">
        {(() => {
          const currentTraining = trainingData.find(t => t.slug === trainingSlug) as any;
          return (
            <>
              <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-8">
                {/* Title */}
                <h1 class="text-3xl font-bold mb-2 text-on-surface">{trainingTitles[trainingSlug] ?? trainingSlug}</h1>
                
                {/* Subtitle */}
                {currentTraining?.subtitle && (
                  <p class="text-xl text-primary font-semibold mb-6">
                    {typeof currentTraining.subtitle === 'object' ? (currentTraining.subtitle as any)[lang] || currentTraining.subtitle.en : currentTraining.subtitle}
                  </p>
                )}

                {/* Image */}
                {currentTraining?.image && (
                  <img
                    src={currentTraining.image}
                    alt={trainingTitles[trainingSlug] ?? trainingSlug}
                    class="w-full rounded-lg shadow-lg mb-6"
                  />
                )}

                {/* Introduction */}
                {currentTraining?.introduction && (
                  <p class="text-lg text-on-surface mb-6 leading-relaxed">
                    {typeof currentTraining.introduction === 'object' ? (currentTraining.introduction as any)[lang] || currentTraining.introduction.en : currentTraining.introduction}
                  </p>
                )}

                {/* Benefits */}
                {currentTraining?.benefits && (
                  <div class="bg-gradient-to-r from-green-50 to-emerald-50 border border-green-400 rounded-xl p-6 mb-8">
                    <h2 class="text-2xl font-bold text-green-800 mb-4">
                      âœ“ {lang === 'vi' ? 'Lá»£i Ã­ch chÃ­nh' : lang === 'ja' ? 'ä¸»ãªåˆ©ç‚¹' : lang === 'es' ? 'Beneficios clave' : lang === 'ko' ? 'ì£¼ìš” ì´ì ' : 'Key Benefits'}
                    </h2>
                    <ul class="space-y-3">
                      {(() => {
                        const benefitsData = typeof currentTraining.benefits === 'object' && !Array.isArray(currentTraining.benefits) 
                          ? (currentTraining.benefits as any)[lang] || currentTraining.benefits.en
                          : currentTraining.benefits;
                        return (benefitsData || []).map((item: string) => (
                          <li class="flex items-start gap-3">
                            <span class="text-green-600 text-xl flex-shrink-0">âœ“</span>
                            <span class="text-gray-700">{item}</span>
                          </li>
                        ));
                      })()}
                    </ul>
                  </div>
                )}

                {/* Features/What You'll Learn */}
                {currentTraining?.features && (
                  <div class="bg-primary/5 border border-primary/20 rounded-xl p-6 mb-8">
                    <h2 class="text-2xl font-bold text-primary mb-4">
                      ğŸ“š {lang === 'vi' ? 'Báº¡n sáº½ há»c Ä‘Æ°á»£c gÃ¬' : lang === 'ja' ? 'å­¦ã¶å†…å®¹' : lang === 'es' ? 'Lo que aprenderÃ¡s' : lang === 'ko' ? 'ë°°ìš¸ ë‚´ìš©' : 'What You\'ll Learn'}
                    </h2>
                    <ul class="space-y-3">
                      {(() => {
                        const featuresData = typeof currentTraining.features === 'object' && !Array.isArray(currentTraining.features) 
                          ? (currentTraining.features as any)[lang] || currentTraining.features.en
                          : currentTraining.features;
                        return (featuresData || []).map((item: string) => (
                          <li class="flex items-start gap-3">
                            <span class="w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"></span>
                            <span class="text-on-surface">{item}</span>
                          </li>
                        ));
                      })()}
                    </ul>
                  </div>
                )}

                {/* What's Included */}
                {currentTraining?.includes && (
                  <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-400 rounded-xl p-6 mb-8">
                    <h2 class="text-2xl font-bold text-blue-800 mb-4">
                      ğŸ {t.whatsIncluded}
                    </h2>
                    <ul class="space-y-3">
                      {(() => {
                        const includesData = typeof currentTraining.includes === 'object' && !Array.isArray(currentTraining.includes) 
                          ? (currentTraining.includes as any)[lang] || currentTraining.includes.en
                          : currentTraining.includes;
                        return (includesData || []).map((item: string) => (
                          <li class="flex items-start gap-3">
                            <span class="text-blue-600 text-xl flex-shrink-0">âœ“</span>
                            <span class="text-gray-700">{item}</span>
                          </li>
                        ));
                      })()}
                    </ul>
                  </div>
                )}

                {/* Why Choose Us - Removed */}
              </div>
            </>
          );
        })()}
      </main>
    </div>
  </div>
</NewsLayout>
