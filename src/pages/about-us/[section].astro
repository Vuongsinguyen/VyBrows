---
import '/src/styles/color.css';
import '/src/styles/global.css';
import NewsLayout from '../../layouts/NewsLayout.astro';
import aboutUsData from '../../content/about-us.json' assert { type: 'json' };

export const prerender = true;

export async function getStaticPaths() {
  return aboutUsData.sections.map(section => ({ 
    params: { 
      section: section.id 
    } 
  }));
}

const lang = 'en'; // English version without prefix
const sectionId = Astro.params.section as string;

// Find current section
const currentSection = aboutUsData.sections.find(section => section.id === sectionId);

// Create section labels for sidebar
const sectionLabels = aboutUsData.sections.reduce((acc, section) => {
  acc[section.id] = section.title.en;
  return acc;
}, {} as Record<string, string>);
---

<NewsLayout title={currentSection ? currentSection.title.en : 'About Us'}>
  <!-- Hero Header Section - Services Style -->
  <section class="relative bg-gradient-to-b from-[var(--color-primary-dark)] to-black pb-12 pt-60">
    <div class="max-w-[1280px] mx-auto px-4 relative z-10 flex flex-col items-center text-left pt-16">
      <!-- Dynamic Heading -->
      <h1 class="text-4xl md:text-5xl font-bold mb-8 text-white text-center" style="font-family: 'Playfair Display', serif;">
        {currentSection ? currentSection.title.en : 'About Us'}
      </h1>
      <p class="text-xl text-white/90 max-w-2xl mx-auto text-center mb-8">
        Learn more about VyBrows Academy
      </p>
    </div>
    <!-- SVG Wave -->
    <div class="absolute inset-0 w-full h-full pointer-events-none select-none">
      <svg class="absolute bottom-0 left-0 w-full h-40" viewBox="0 0 1440 320" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill="var(--color-primary-dark)" fill-opacity="1" d="M0,288L80,272C160,256,320,224,480,197.3C640,171,800,149,960,154.7C1120,160,1280,192,1360,208L1440,224L1440,320L1360,320C1280,320,1120,320,960,320C800,320,640,320,480,320C320,320,160,320,80,320L0,320Z"/>
      </svg>
    </div>
  </section>

  <!-- Breadcrumb -->
  <div class="bg-gray-50 border-b">
    <div class="max-w-7xl mx-auto px-6 py-3">
      <nav class="flex items-center text-sm text-gray-600">
        <a href="/" class="hover:text-[#8B4513] transition-colors">Home</a>
        <svg class="w-4 h-4 mx-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
        <a href="/about-us" class="hover:text-[#8B4513] transition-colors">About Us</a>
        <svg class="w-4 h-4 mx-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
        <span class="text-gray-900 font-medium">{currentSection ? currentSection.title.en : 'Section'}</span>
      </nav>
    </div>
  </div>

  <div class="w-full bg-surface flex justify-center">
    <div class="w-full max-w-7xl bg-surface flex gap-6 items-start px-6 py-8">
      <!-- Left Sidebar -->
      <aside class="w-64 bg-surface rounded-lg shadow p-4 mt-4 lg:mt-0 lg:sticky lg:top-32 z-20 border border-border">
        <h2 class="font-bold text-lg mb-2 text-on-surface">About Us</h2>
        <ul class="border border-border rounded-lg overflow-hidden">
          {aboutUsData.sections.map((section, index) => (
            <li>
              <a 
                href={`/about-us/${section.id}`} 
                class={`block bg-surface rounded-none ${index < aboutUsData.sections.length - 1 ? 'border-b border-border' : ''} px-3 py-2 text-on-surface font-normal hover:text-primary ${section.id === sectionId ? 'bg-primary/10 text-primary font-semibold' : ''}`}
              >
                {section.title.en}
              </a>
            </li>
          ))}
        </ul>
      </aside>

      <!-- Main Content -->
      <main class="flex-1 space-y-12">
        {currentSection ? (
          <>
            <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-8">
              <h1 class="text-3xl font-bold mb-6 text-primary">{currentSection.title.en}</h1>
              
              {/* Content */}

              {/* Content */}
              <div class="prose prose-lg max-w-none text-on-surface" set:html={currentSection.content.en}></div>


            </div>

            {/* Navigation to Other Sections */}
            <div class="bg-gradient-to-r from-primary/5 to-primary/10 rounded-lg p-6">
              <h3 class="text-lg font-bold text-primary mb-4">Explore More About Us</h3>
              <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                {aboutUsData.sections.filter(section => section.id !== sectionId).slice(0, 3).map((section) => (
                  <a 
                    href={`/about-us/${section.id}`}
                    class="block p-4 bg-white rounded-lg border border-gray-200 hover:border-primary hover:shadow-md transition-all duration-300 group"
                  >
                    <h4 class="font-semibold text-primary group-hover:text-primary-dark transition-colors mb-2">
                      {section.title.en}
                    </h4>
                    <p class="text-sm text-gray-600 line-clamp-2">
                      Learn more about this aspect of VyBrows Academy...
                    </p>
                    <div class="flex items-center text-primary text-xs font-medium mt-2 group-hover:gap-1 transition-all duration-300">
                      <span>Read More</span>
                      <svg class="w-3 h-3 transform group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                      </svg>
                    </div>
                  </a>
                ))}
              </div>
            </div>

            {/* Call to Action */}
            <div class="bg-primary/10 border border-primary rounded-xl p-6 text-center">
              <h3 class="text-xl font-bold text-primary mb-2">Ready to Start Your Journey?</h3>
              <p class="text-on-surface mb-4">
                Join VyBrows Academy and discover the art of permanent makeup with our expert training programs.
              </p>
              <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a 
                  href="/contact" 
                  class="inline-block px-8 py-3 bg-primary text-white font-semibold rounded-lg hover:bg-primary-dark transition-colors"
                >
                  Contact Us
                </a>
                <a 
                  href="/training" 
                  class="inline-block px-8 py-3 border border-primary text-primary font-semibold rounded-lg hover:bg-primary hover:text-white transition-colors"
                >
                  View Training
                </a>
              </div>
            </div>
          </>
        ) : (
          <div class="text-center py-12">
            <h1 class="text-2xl font-bold text-gray-600 mb-4">Section Not Found</h1>
            <p class="text-gray-500 mb-6">The requested section could not be found.</p>
            <a 
              href="/about-us" 
              class="inline-block px-6 py-3 bg-primary text-white font-semibold rounded-lg hover:bg-primary-dark transition-colors"
            >
              Return to About Us
            </a>
          </div>
        )}
      </main>
    </div>
  </div>
</NewsLayout>

<style>
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>