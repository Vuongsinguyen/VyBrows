---
/* Frontmatter có thể để trống hoặc thêm logic server nếu cần */
---
<section class="pt-16 pb-8 px-4 md:px-0 bg-[#003324] contact-section">
  <div class="max-w-7xl mx-auto">
    <h2
      class="text-4xl md:text-5xl font-extrabold text-center mb-8 font-lora tracking-tight"
      style="color:#f8f7dc; font-family:'Lora', serif;"
    >
      Contact Us
    </h2>

    <div class="w-full mb-8">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 bg-[#003324] text-white rounded-2xl text-base items-start">
        <div class="flex flex-col gap-4">
          <div class="border border-white/20 rounded-xl px-4 py-3 flex items-center">
            <span class="inline-flex items-center justify-center w-12 h-12 rounded-full border border-white/80 mr-3" style="border-width:1px; background:transparent;">
              <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 20 20" style="color: var(--color-black2white);">
                <path d="M10 2C6.13 2 3 5.13 3 9c0 5.25 7 11 7 11s7-5.75 7-11c0-3.87-3.13-7-7-7zm0 9.5A2.5 2.5 0 1 1 10 6a2.5 2.5 0 0 1 0 5.5z"/>
              </svg>
            </span>
            <div>
              <div class="font-bold text-lg mb-1">Address:</div>
              <div>13192 Bellaire Blvd #B, Houston, TX 77072</div>
            </div>
          </div>
          <div class="border border-white/20 rounded-xl px-4 py-3 flex items-center">
            <span class="inline-flex items-center justify-center w-12 h-12 rounded-full border border-white/80 mr-3" style="border-width:1px; background:transparent;">
              <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 20 20" style="color: var(--color-black2white);">
                <path d="M2 3.5A1.5 1.5 0 0 1 3.5 2h13A1.5 1.5 0 0 1 18 3.5v13a1.5 1.5 0 0 1-1.5 1.5h-13A1.5 1.5 0 0 1 2 16.5v-13zm2 0v13h12v-13H4zm6 2a1 1 0 0 1 1 1v1h2a1 1 0 1 1 0 2h-2v2a1 1 0 1 1-2 0v-2H6a1 1 0 1 1 0-2h2V6a1 1 0 0 1 1-1z"/>
              </svg>
            </span>
            <div>
              <div class="font-bold text-lg mb-1">Phone:</div>
              <div>346-409-9999 | 346-409-8888 <span class="text-sm">(English Speaker)</span></div>
            </div>
          </div>
        </div>
        <div class="flex flex-col gap-4">
          <div class="border border-white/20 rounded-xl px-4 py-3 flex items-center">
            <span class="inline-flex items-center justify-center w-12 h-12 rounded-full border border-white/80 mr-3" style="border-width:1px; background:transparent;">
              <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 36 30" style="color: var(--color-black2white);">
                <path d="M36.1714 4.4374C36.1714 2.4574 34.5514 0.837402 32.5714 0.837402H3.77145C1.79145 0.837402 0.171448 2.4574 0.171448 4.4374V26.0374C0.171448 28.0174 1.79145 29.6374 3.77145 29.6374H32.5714C34.5514 29.6374 36.1714 28.0174 36.1714 26.0374V4.4374ZM32.5714 4.4374L18.1714 13.4374L3.77145 4.4374H32.5714ZM32.5714 26.0374H3.77145V8.0374L18.1714 17.0374L32.5714 8.0374V26.0374Z" />
              </svg>
            </span>
            <div>
              <div class="font-bold text-lg mb-1">Email:</div>
              <div>contact@vybrows-academy.com</div>
            </div>
          </div>
          <div class="border border-white/20 rounded-xl px-4 py-3 flex items-center">
            <span class="inline-flex items-center justify-center w-12 h-12 rounded-full border border-white/80 mr-3" style="border-width:1px; background:transparent;">
              <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 20 20" style="color: var(--color-black2white);">
                <path d="M6 2a1 1 0 0 0-1 1v2h10V3a1 1 0 0 0-1-1H6zm-1 5v9a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V7H5zm2 2h6v2H7V9z"/>
              </svg>
            </span>
            <div>
              <div class="font-bold text-lg mb-1">Open Hours:</div>
              <div class="flex gap-4 flex-wrap">
                <span>Mon – Fri: 10:00 – 18:00</span>
                <span>Sat &amp; Sun: 10:00 – 17:00</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="flex flex-col md:flex-row items-stretch gap-[34px]">
      <div class="w-full md:w-1/2 my-6 md:my-8 rounded-2xl shadow-lg bg-[var(--color-card-bg)] overflow-hidden">
        <iframe
          class="w-full h-64 md:h-[500px] object-cover"
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3465.546055721214!2d-95.61564448830596!3d29.703937974993018!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8640ddecac735047%3A0xa513ff1ff0b5ffe8!2sVyBrows%20Academy!5e0!3m2!1sen!2s!4v1755529433006!5m2!1sen!2s"
        ></iframe>
      </div>

      <div class="w-full md:w-1/2 my-6 md:my-8 mx-0 rounded-2xl shadow-lg bg-[var(--color-card-bg)]">
        <form id="contactForm" class="px-4 py-8 flex flex-col gap-4">
          <div class="mb-4">
            <label for="name" class="block text-sm font-medium mb-1 font-lora text-[#003324]">Name</label>
            <input type="text" name="name" id="name" required class="w-full px-4 py-2 rounded-lg bg-gray-900 text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-green-400" placeholder="Your Name" />
          </div>
          <div class="mb-4">
            <label for="email" class="block text-sm font-medium mb-1 font-lora text-[#003324]">Email</label>
            <input type="email" name="email" id="email" required class="w-full px-4 py-2 rounded-lg bg-gray-900 text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-green-400" placeholder="Your Email" />
          </div>
            <div class="mb-4">
              <label for="phone" class="block text-sm font-medium mb-1 font-lora text-[#003324]">Phone</label>
              <input type="text" name="phone" id="phone" required class="w-full px-4 py-2 rounded-lg bg-gray-900 text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-green-400" placeholder="Phone Number" />
            </div>
            <div class="mb-4">
              <label for="service" class="block text-sm font-medium mb-1 font-lora text-[#003324]">Service</label>
              <select name="service" id="service" required class="w-full px-4 py-2 rounded-lg bg-gray-900 text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-green-400">
                <option value="">Select Service</option>
                <option value="brows">Brows</option>
                <option value="lashes">Lashes</option>
                <option value="facial">Facial</option>
                <option value="training">Training</option>
              </select>
            </div>
            <div class="mb-4">
              <label for="message" class="block text-sm font-medium mb-1 font-lora text-[#003324]">Message</label>
              <textarea name="message" id="message" rows="4" class="w-full px-4 py-2 rounded-lg bg-gray-900 text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-green-400" placeholder="Your message..."></textarea>
            </div>
            <div id="formStatusWrapper">
              <button
                type="submit"
                class="mt-2 px-6 rounded-lg bg-[#003324] hover:bg-[#004d39] text-white font-bold text-lg shadow transition self-center"
                style="min-width:120px; padding-top:14px; padding-bottom:14px;"
              >
                Submit
              </button>
              <div id="formStatus" aria-live="polite"></div>
            </div>
        </form>
      </div>
    </div>
  </div>
</section>

<style>
@import url('https://fonts.googleapis.com/css2?family=Lora:wght@400;500;600;700&display=swap');
.font-lora { font-family: 'Lora', serif; }

.contact-section {
  font-family: 'Lora', serif;
  font-size:16px;
  line-height:1.5;
}
.contact-section label,
.contact-section input,
.contact-section select,
contact-section textarea,
.contact-section button,
.contact-section div,
.contact-section span,
.contact-section p {
  font-size:16px;
}

/* giữ nguyên kích thước h2 do tailwind đặt */
#formStatusWrapper { position:relative; display:inline-block; }
#formStatus { position:relative; margin-top:.6rem; padding:.65rem .9rem; border-radius:.6rem; font-size:.85rem; line-height:1.3; background:#003324; color:#f8f7dc; border:1px solid rgba(255,255,255,.18); box-shadow:0 4px 14px -4px rgba(0,0,0,.45); opacity:0; transform:translateY(-4px); transition:opacity .25s ease, transform .25s ease; max-width:360px; }
#formStatus.show { opacity:1; transform:translateY(0); }
#formStatus.success { border-color:#16a34a; }
#formStatus.error { border-color:#dc2626; }
#formStatus .close-btn { position:absolute; top:4px; right:6px; cursor:pointer; font-weight:600; opacity:.65; }
#formStatus .close-btn:hover { opacity:1; }
</style>

<script>
(function() {
  const statusEl = () => document.getElementById('formStatus');
  function setStatus(msg: string, type?: string) {
    const el = statusEl();
    if (!el) return;
    el.className = '';
    el.id = 'formStatus';
    if (type) el.classList.add(type);
    el.innerHTML = `<span class="close-btn" aria-label="Close" title="Close">×</span>${msg}`;
    requestAnimationFrame(()=> el.classList.add('show'));
    el.querySelector('.close-btn')?.addEventListener('click', () => el.classList.remove('show'));
  }
  function autoHide(ms:number=3500) {
    const el = statusEl();
    if (!el) return;
    setTimeout(()=> el.classList.remove('show'), ms);
  }

  document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('contactForm') as HTMLFormElement | null;
  if (!form) return;
  const submitBtn = form.querySelector('button[type="submit"]') as HTMLButtonElement | null;

    const params = new URLSearchParams(location.search);
    ['name','email','phone','service','message'].forEach(k => {
      const v = params.get(k);
      if (!v) return;
  const field = form.querySelector('[name="'+k+'"]') as HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement | null;
  if (field) (field as any).value = v;
    });

    form.addEventListener('submit', async (e: SubmitEvent) => {
      e.preventDefault();
      if (form.dataset.sending === '1') return;
      form.dataset.sending = '1';
      if (submitBtn) {
        submitBtn.disabled = true;
        submitBtn.dataset.originalText = submitBtn.textContent;
        submitBtn.textContent = 'Sending...';
      }
      setStatus('Đang gửi...', 'info');

      const fd = new FormData(form as HTMLFormElement);
      const payload: Record<string,string> = {};
      fd.forEach((val, key) => { payload[key] = String(val); });

      try {
        const res = await fetch('/.netlify/functions/sendMail', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        let result: any = {};
        try { result = await res.json(); } catch {}
        if (res.ok && (result as any).success) {
          setStatus('✅ Gửi thành công!', 'success');
          form.reset();
          autoHide();
        } else {
          setStatus('❌ Gửi thất bại: ' + ((result as any).error || 'Send failed'), 'error');
        }
      } catch (err) {
        setStatus('❌ Lỗi mạng (không gửi được)', 'error');
      } finally {
        if (submitBtn) {
          submitBtn.disabled = false;
          submitBtn.textContent = submitBtn.dataset.originalText || 'Submit';
        }
        delete form.dataset.sending;
      }
    });
  });
})();
</script>