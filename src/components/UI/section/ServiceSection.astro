---
import ServicesCard from "../cards/ServicesCard.astro";
export interface Props {
  title?: string;
  description?: string;
  image?: string;
  link?: string;
  class?: string;
  heading?: string;
}

const { class: customClass = '', heading } = Astro.props;

// Detect current language from URL
const currentLang = Astro.url.pathname.split('/')[1] || 'en';

import { getCollection } from 'astro:content';
const allServices = await getCollection('services');
const dynamicServices = allServices
  .filter(s => s.data.lang === currentLang)
  .sort((a, b) => (a.data.order ?? 99) - (b.data.order ?? 99));
const services = allServices.filter(s => s.data.lang === currentLang);

const sectionTitles = {
  en: "Signature Services by Vybrows Academy",
  vi: "Dịch vụ đặc trưng bởi Vybrows Academy",
  ja: "Servicios exclusivos de Vybrows Academy" // giữ key là ja, nội dung tiếng Tây Ban Nha
};

const sectionTitle = heading || sectionTitles[currentLang as keyof typeof sectionTitles] || sectionTitles.en;

const sectionDescriptions = {
  en: `At VyBrows Academy, permanent makeup is both an art and a science, and we’ve mastered the equation to unleash a woman’s true beauty. Every customer’s features are unique, so we attend to each of them with an exceptional level of service to deliver effortlessly natural results. Our team is trained in following the highest standards of hygiene and professionalism to ensure your comfort and safety across all our permanent makeup services.`,
  vi: `Tại VyBrows Academy, phun xăm thẩm mỹ vừa là nghệ thuật vừa là khoa học, và chúng tôi đã nắm vững công thức để tôn vinh vẻ đẹp thực sự của người phụ nữ. Mỗi khách hàng đều có nét riêng, vì vậy chúng tôi chăm sóc từng người với dịch vụ tận tâm để mang lại kết quả tự nhiên nhất. Đội ngũ của chúng tôi được đào tạo theo tiêu chuẩn vệ sinh và chuyên nghiệp cao nhất để đảm bảo sự thoải mái và an toàn cho bạn ở mọi dịch vụ phun xăm.`,
  ja: `En VyBrows Academy, el maquillaje permanente es tanto un arte como una ciencia, y hemos dominado la ecuación para revelar la verdadera belleza de una mujer. Cada cliente es único, por eso ofrecemos un nivel excepcional de servicio para lograr resultados naturales sin esfuerzo. Nuestro equipo está capacitado en los más altos estándares de higiene y profesionalismo para garantizar tu comodidad y seguridad en todos nuestros servicios de maquillaje permanente.`
};

const sectionDescription = sectionDescriptions[currentLang as keyof typeof sectionDescriptions] || sectionDescriptions.en;

// Base prefix by lang for links
const basePrefix = currentLang === 'en' ? '' : `/${currentLang}`;
---

<section id="signature-services" 
  class={`pt-[44px] pb-16 md:py-16 px-6 ${customClass}`} 
  style="background: var(--color-bg);"
  <div class="max-w-7xl mx-auto">
    <!-- Section Title -->
    <h2 class="text-4xl md:text-5xl font-bold font-lora text-center mb-8" style="color: var(--color-black); font-family: 'Lora', serif;">
      {sectionTitle}
    </h2>
    <!-- Section Description -->
    <p class="text-lg md:text-xl text-center mb-10 font-lora" style="color: var(--color-text-secondary); font-family: 'Lora', serif;">
      {sectionDescription}
    </p>
    <!-- Services Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {dynamicServices.map((service) => (
        <ServicesCard
          title={service.data.title}
          description={service.data.description}
          image={service.data.image}
          link={`/${currentLang}/service/${service.id}`}
          class="h-full"
        />
      ))}
    </div>

    <!-- CTA -->
    <div class="mt-10 flex justify-center">
      <div class="flex flex-row gap-3 flex-wrap justify-center">
        <a
          href={`${basePrefix}/#contact`}
          class="inline-flex items-center justify-center px-6 py-3 rounded-lg font-bold text-base shadow transition-colors focus:outline-none focus-visible:ring-2"
          style="background: #003324; color:#FFD895;"
          aria-label="Book a Consultation"
        >
          Book a Consultation
        </a>
        <a
          href={`${basePrefix}/#contact`}
          class="inline-flex items-center justify-center px-6 py-3 rounded-lg font-bold text-base border transition-colors focus:outline-none focus-visible:ring-2 hover:bg-white/10"
          style="border-color: #003324; color: #003324;"
          aria-label="Book a Reservation"
        >
          Book a Reservation
        </a>
      </div>
    </div>
  </div>
</section>

