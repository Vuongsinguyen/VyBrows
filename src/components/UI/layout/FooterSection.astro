---
// FooterSection.astro - Professional footer with 4 columns
import { getServiceMenu, menus } from '../../../content/menu.ts';
export interface Props {
  class?: string;
}

const { class: customClass = '' } = Astro.props;

// Lấy ngôn ngữ hiện tại từ URL
const pathParts = Astro.url.pathname.split('/').filter(Boolean);
// If first part is 'service', it's English version without lang prefix
const currentLang = (pathParts[0] === 'service' || pathParts[0] === 'about-us' || pathParts[0] === 'contact' || pathParts[0] === 'training' || pathParts[0] === 'news') 
  ? 'en' 
  : (pathParts[0] || 'en');
const menuItems = menus[currentLang] || menus['en'];

// Lấy danh sách dịch vụ từ getServiceMenu (async)
const serviceLinks = await getServiceMenu(currentLang);

const socialLinks = [
  {
    name: "Facebook",
    href: "https://www.facebook.com/vybrows",
    icon: "M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"
  },
  {
    name: "Phone",
    href: "tel:(346)-409.9999",
    icon: "M5.59347 10.624C7.51347 14.3973 10.6068 17.4773 14.3801 19.4106L17.3135 16.4773C17.6735 16.1173 18.2068 15.9973 18.6735 16.1573C20.1668 16.6506 21.7801 16.9173 23.4335 16.9173C24.1668 16.9173 24.7668 17.5173 24.7668 18.2506V22.904C24.7668 23.6373 24.1668 24.2373 23.4335 24.2373C10.9135 24.2373 0.7668 14.0906 0.7668 1.57064C0.7668 0.837305 1.3668 0.237305 2.10013 0.237305H6.7668C7.50013 0.237305 8.10013 0.837305 8.10013 1.57064C8.10013 3.2373 8.3668 4.83731 8.86013 6.33064C9.0068 6.79731 8.90013 7.31731 8.5268 7.69064L5.59347 10.624Z"
  },
  {
    name: "Instagram",
    href: "https://www.instagram.com/vybrowsbeauty?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==",
    icon: "M12 0.237305C15.26 0.237305 15.6672 0.251974 16.9463 0.30957C18.2239 0.367974 19.0981 0.571987 19.8613 0.867188C20.6615 1.16867 21.3862 1.64092 21.9854 2.25098C22.5958 2.85044 23.0688 3.5762 23.3701 4.37695C23.6668 5.14001 23.8693 6.01279 23.9277 7.29004C23.9862 8.57004 24 8.9781 24 12.2373C24 15.4965 23.9862 15.9045 23.9277 17.1846C23.8693 18.4621 23.6662 19.3354 23.3701 20.0986C23.0687 20.8988 22.5964 21.6235 21.9863 22.2227C21.3864 22.8339 20.6611 23.3066 19.8613 23.6074C19.0981 23.9042 18.2248 24.1066 16.9473 24.165C15.6672 24.2235 15.2592 24.2373 12 24.2373C8.7408 24.2373 8.33274 24.2235 7.05273 24.165C5.77535 24.1066 4.90276 23.9034 4.13965 23.6074C3.3393 23.306 2.61395 22.8338 2.01465 22.2236C1.40359 21.6238 0.931674 20.8983 0.630859 20.0986C0.334066 19.3354 0.130672 18.4621 0.0722656 17.1846C0.0138616 15.9045 0 15.4973 0 12.2373C7.11643e-09 8.97739 0.0146694 8.57014 0.0722656 7.29102C0.130662 6.01358 0.334745 5.14008 0.629883 4.37695C0.931357 3.57659 1.40349 2.85124 2.01367 2.25195C2.61367 1.64074 3.33966 1.16897 4.13965 0.868164C4.90278 0.571424 5.77531 0.367972 7.05273 0.30957C8.33274 0.251166 8.7408 0.237305 12 0.237305ZM12 2.39941C8.796 2.39941 8.41598 2.41213 7.15039 2.46973C5.9812 2.52331 5.34605 2.71804 4.92285 2.88281C4.40159 3.07479 3.92915 3.38094 3.54199 3.7793C3.1228 4.1993 2.8623 4.60015 2.64551 5.16016C2.47995 5.58336 2.28601 6.2185 2.23242 7.3877C2.17482 8.65329 2.16211 9.0333 2.16211 12.2373C2.16211 15.4413 2.17482 15.8214 2.23242 17.0869C2.28601 18.2561 2.48074 18.8912 2.64551 19.3145C2.8376 19.8356 3.14374 20.3081 3.54199 20.6953C3.9292 21.0936 4.40162 21.3998 4.92285 21.5918C5.34605 21.7574 5.98121 21.9513 7.15039 22.0049C8.41598 22.0625 8.79519 22.0752 12 22.0752C15.2048 22.0752 15.5841 22.0625 16.8496 22.0049C18.0188 21.9513 18.6539 21.7566 19.0771 21.5918C19.5984 21.3999 20.0709 21.0937 20.458 20.6953C20.8563 20.3081 21.1625 19.8357 21.3545 19.3145C21.5201 18.8912 21.714 18.2561 21.7676 17.0869C21.8252 15.8214 21.8379 15.4413 21.8379 12.2373C21.8379 9.0333 21.8252 8.65329 21.7676 7.3877C21.714 6.21851 21.5193 5.58336 21.3545 5.16016C21.1378 4.60015 20.878 4.1993 20.458 3.7793C20.038 3.3601 19.6372 3.0996 19.0771 2.88281C18.6539 2.71725 18.0188 2.52332 16.8496 2.46973C15.5841 2.41213 15.204 2.39941 12 2.39941ZM12 6.06934C13.6358 6.06934 15.2046 6.71925 16.3613 7.87598C17.5181 9.0327 18.168 10.6015 18.168 12.2373C18.168 13.8731 17.5181 15.442 16.3613 16.5986C15.2046 17.7554 13.6358 18.4053 12 18.4053C10.3642 18.4053 8.79539 17.7554 7.63867 16.5986C6.48194 15.442 5.83203 13.8731 5.83203 12.2373C5.83203 10.6015 6.48195 9.0327 7.63867 7.87598C8.79539 6.71925 10.3642 6.06934 12 6.06934ZM12 8.2334C11.4742 8.2334 10.9536 8.33688 10.4678 8.53809C9.98201 8.73931 9.54074 9.03444 9.16895 9.40625C8.79714 9.77806 8.502 10.2193 8.30078 10.7051C8.09957 11.1908 7.99609 11.7115 7.99609 12.2373C7.99609 12.7631 8.09957 13.2838 8.30078 13.7695C8.50199 14.2553 8.79715 14.6965 9.16895 15.0684C9.54074 15.4401 9.98201 15.7353 10.4678 15.9365C10.9536 16.1378 11.4742 16.2412 12 16.2412C13.062 16.2412 14.0801 15.8192 14.8311 15.0684C15.5819 14.3174 16.0039 13.2992 16.0039 12.2373C16.0039 11.1754 15.5819 10.1572 14.8311 9.40625C14.0801 8.65536 13.062 8.2334 12 8.2334ZM18.5049 4.49902C18.8914 4.49913 19.2618 4.65343 19.5352 4.92676C19.8084 5.20012 19.9618 5.57048 19.9619 5.95703C19.9619 6.34371 19.8085 6.71485 19.5352 6.98828C19.2618 7.26154 18.8913 7.41493 18.5049 7.41504C18.1182 7.41504 17.7471 7.26165 17.4736 6.98828C17.2003 6.71485 17.0459 6.34371 17.0459 5.95703C17.046 5.5705 17.2004 5.20011 17.4736 4.92676C17.7471 4.65334 18.1181 4.49902 18.5049 4.49902Z"
  }
];
---

<footer class={`bg-[#002319] text-white py-16 ${customClass}`}>
  <div class="max-w-7xl mx-auto px-6">
    <!-- Main Footer Content -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12">
      
      <!-- Logo Column -->
      <div>
        <a href={currentLang === 'en' ? '/' : `/${currentLang}`} class="block mb-6">
          <img src="/logo.webp" alt="VyBrows Academy" class="w-48 h-auto" />
        </a>
        <p class="text-gray-300 text-sm leading-relaxed">
          {({
            en: "VyBrows Academy - Excellence in permanent makeup artistry and training.",
            vi: "VyBrows Academy - Xuất sắc trong nghệ thuật phun xăm thẩm mỹ và đào tạo.",
            ja: "VyBrows Academy - アートメイクと教育における卓越性。",
            ko: "VyBrows Academy - 반영구 화장 예술 및 교육의 우수성.",
            es: "VyBrows Academy - Excelencia en arte de maquillaje permanente y formación."
          })[currentLang]}
        </p>
      </div>

      <!-- Services Column -->
      <div>
  <h3 class="text-lg font-bold uppercase tracking-wide mb-6 font-lora" style="color: var(--color-black2white); font-family: 'Lora', serif;">
    {({
      en: "SERVICES",
      vi: "DỊCH VỤ",
      ja: "サービス",
      ko: "서비스",
      es: "SERVICIOS"
    })[currentLang]}
  </h3>
        <ul class="space-y-3">
          {serviceLinks.map((service) => (
            <li>
              <a href={service.href} class="text-gray-300 hover:text-white transition-colors duration-200 text-sm leading-relaxed">
                {service.title}
              </a>
            </li>
          ))}
        </ul>
      </div>

      <!-- About Us Column -->
      <div>
        {(() => {
          // Tìm menu About Us dựa vào children có chứa "about-us" trong href
          const aboutMenu = menuItems.find(item => item.children && item.children.some(child => child.href.includes('/about-us/')));
          const aboutLinks = aboutMenu?.children || [];
          
          // Lấy label header từ menu item tìm được
          const headerLabel = aboutMenu?.label || 'ABOUT US';
          
          return (
            <>
              <h3 class="text-lg font-bold uppercase tracking-wide mb-6 font-lora" style="color: var(--color-black2white); font-family: 'Lora', serif;">
                {headerLabel}
              </h3>
              <ul class="space-y-3">
                {aboutLinks.map(link => (
                  <li>
                    <a href={link.href} class="text-gray-300 hover:text-white transition-colors duration-200 text-sm leading-relaxed">
                      {link.label}
                    </a>
                  </li>
                ))}
              </ul>
            </>
          );
        })()}
      </div>

      <!-- Explore Column -->
      <div>
        <h3 class="text-lg font-bold uppercase tracking-wide mb-6 font-lora" style="color: var(--color-black2white); font-family: 'Lora', serif;">
          {({
            en: "EXPLORE",
            vi: "KHÁM PHÁ",
            ja: "探索",
            ko: "탐색",
            es: "EXPLORAR"
          })[currentLang]}
        </h3>
        <ul class="space-y-3 mb-8">
          <!-- Bạn có thể bổ sung dữ liệu mới cho cột này tại đây -->
        </ul>

        <!-- Social Links -->
        <div class="flex gap-3">
          {socialLinks.map((social) => (
            social.name === "Facebook"
              ? <a
                  href="fb://page/vybrows"
                  onclick="setTimeout(() => { window.location = 'https://www.facebook.com/vybrows'; }, 500);"
                  class="w-10 h-10 border-[1px] border-white rounded-lg flex items-center justify-center text-white hover:bg-white/10 transition-colors duration-200"
                  aria-label="Facebook"
                >
                  <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                    <path d={social.icon} />
                  </svg>
                </a>
              : <a
                  href={social.href}
                  class="w-10 h-10 border-[1px] border-white rounded-lg flex items-center justify-center text-white hover:bg-white/10 transition-colors duration-200"
                  aria-label={social.name}
                >
                  <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                    <path d={social.icon} />
                  </svg>
                </a>
          ))}
        </div>

        <!-- Facebook Fanpage -->
        <div class="mt-6">
          <div class="w-full max-w-[280px]">
            <iframe 
              src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2Fvybrows%2F&tabs=timeline&width=280&height=300&small_header=false&adapt_container_width=true&hide_cover=false&show_facepile=true&appId"
              width="100%" 
              height="300" 
              style="border:none;overflow:hidden" 
              scrolling="no" 
              frameborder="0" 
              allowfullscreen="true" 
              allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share">
            </iframe>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer Bottom -->
    <div class="border-t border-gray-800 pt-8">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <!-- Copyright -->
        <div class="text-gray-400 text-sm mb-4 md:mb-0">
          {({
            en: "©2025 Copyrights by VyBrows Academy",
            vi: "©2025 Bản quyền thuộc về VyBrows Academy",
            ja: "©2025 VyBrows Academy 著作権所有",
            ko: "©2025 VyBrows Academy 저작권",
            es: "©2025 Derechos de autor por VyBrows Academy"
          })[currentLang]}
        </div>

        <!-- Version -->
        <div class="text-gray-400 text-sm">
          {({
            en: "Version 1.0 - Design by",
            vi: "Phiên bản 1.0 - Thiết kế bởi",
            ja: "バージョン 1.0 - デザイン",
            ko: "버전 1.0 - 디자인",
            es: "Versión 1.0 - Diseñado por"
          })[currentLang]}
          <a
            href="https://www.facebook.com/vuongsinguyen.info/"
            target="_blank"
            rel="noopener noreferrer"
            class="ml-1 text-gray-300 hover:text-white no-underline transition-colors"
            aria-label="Facebook của VUONG SI NGUYEN"
          >
            VUONG SI NGUYEN
          </a>
        </div>
      </div>
    </div>
  </div>
</footer>

<style>
  /* Smooth scrolling for anchor links */
  footer a {
    scroll-behavior: smooth;
    text-decoration: none; /* remove underline */
  }
  footer a:hover,
  footer a:focus {
    text-decoration: none; /* ensure no underline on hover/focus */
  }

  /* Hover effect for links */
  footer a:hover {
    transform: translateX(2px);
    transition: transform 0.2s ease-in-out;
  }
</style>