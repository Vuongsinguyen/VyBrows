---
import '../styles/global.css';
export interface Props {
  title: string;
}
const { title } = Astro.props;

// Lấy ngôn ngữ từ URL
const lang = Astro.url.pathname.split('/')[1] || 'en';

// Xác định ngôn ngữ hợp lệ
const validLangs = ['en', 'vi', 'ja', 'es', 'ko'];
const currentLang = validLangs.includes(lang) ? lang : 'en';

// Tạo alternate URLs cho hreflang
const pathname = Astro.url.pathname;
const baseUrl = 'https://vybrowsbeauty.com';

// Extract path without language prefix
let pathWithoutLang = pathname;
if (validLangs.some(l => pathname.startsWith(`/${l}/`) || pathname === `/${l}`)) {
  pathWithoutLang = pathname.replace(/^\/(en|vi|ja|es|ko)(\/|$)/, '/');
}
// Ensure path starts with /
if (!pathWithoutLang.startsWith('/')) {
  pathWithoutLang = '/' + pathWithoutLang;
}
// Remove trailing slash for consistency (except root)
if (pathWithoutLang !== '/' && pathWithoutLang.endsWith('/')) {
  pathWithoutLang = pathWithoutLang.slice(0, -1);
}

import Header from '../components/UI/layout/Header.astro';
---

<!DOCTYPE html>
<html lang={currentLang}>
  <head>
    <meta charset="UTF-8" />
    
    <!-- PageMap for Google Custom Search thumbnail -->
    <!--
    <PageMap>
      <DataObject type="thumbnail">
        <Attribute name="src" value="https://vybrowsbeauty.com/images/SEO.png"/>
        <Attribute name="width" value="1200"/>
        <Attribute name="height" value="630"/>
      </DataObject>
    </PageMap>
    -->
    
    <!-- Thumbnail meta tag for search engines -->
    <meta name="thumbnail" content="https://vybrowsbeauty.com/images/SEO.png" />
    
    <!-- Apply theme early (avoid FOUC) -->
    <script is:inline>
      (() => {
        try {
          const t = localStorage.getItem('theme');
          const dark = t ? t === 'dark' : window.matchMedia('(prefers-color-scheme: dark)').matches;
          document.documentElement.classList.toggle('dark', dark);
        } catch {}
      })();
    </script>
    <meta name="description" content="VYBROWS ACADEMY | America's Premier PMU Training Institute - Professional Permanent Makeup Certification, Advanced Microblading Courses & Beauty Academy Training" />
    <meta name="keywords" content="VYBROWS ACADEMY, permanent makeup training, PMU certification, professional microblading academy, advanced beauty training, permanent makeup courses, PMU studio academy, eyebrow tattoo training, lip blush certification, cosmetic tattoo academy, semi permanent makeup school" />
    <meta name="author" content="VYBROWS ACADEMY" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content={currentLang} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={Astro.url} />
    
    <!-- Hreflang Tags for Multilingual SEO -->
    <link rel="alternate" hreflang="en" href={`${baseUrl}${pathWithoutLang === '/' ? '/' : '/en' + pathWithoutLang}`} />
    <link rel="alternate" hreflang="vi" href={`${baseUrl}/vi${pathWithoutLang}`} />
    <link rel="alternate" hreflang="ja" href={`${baseUrl}/ja${pathWithoutLang}`} />
    <link rel="alternate" hreflang="es" href={`${baseUrl}/es${pathWithoutLang}`} />
    <link rel="alternate" hreflang="ko" href={`${baseUrl}/ko${pathWithoutLang}`} />
    <link rel="alternate" hreflang="x-default" href={`${baseUrl}${pathWithoutLang === '/' ? '/' : '/en' + pathWithoutLang}`} />
    
    <!-- Primary Domain Declaration -->
    <meta name="google-site-verification" content="your-verification-code" />
    <meta name="msvalidate.01" content="your-bing-verification-code" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={Astro.url} />
    <meta property="og:title" content="VYBROWS ACADEMY | #1 PMU Studio & Academy - Professional Permanent Makeup & Beauty Services" />
    <meta property="og:description" content="Leading permanent makeup studio specializing in microblading, PMU services, and natural beauty enhancements. Expert artists, safe techniques, stunning results." />
    <meta property="og:image" content="https://vybrowsbeauty.com/images/SEO.png" />
    <meta property="og:image:secure_url" content="https://vybrowsbeauty.com/images/SEO.png" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="VYBROWS ACADEMY - Premier PMU Training Institute" />
    <meta property="og:site_name" content="VYBROWS ACADEMY | #1 PMU Studio & Academy" />
    <meta property="og:locale" content="en_US" />
    <meta property="article:author" content="VYBROWS ACADEMY" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={Astro.url} />
    <meta property="twitter:title" content="VYBROWS ACADEMY | #1PMU Studio & Academy - Professional Permanent Makeup & Beauty Services" />
    <meta property="twitter:description" content="Leading permanent makeup studio specializing in microblading, PMU services, and natural beauty enhancements. Expert artists, safe techniques, stunning results." />
    <meta property="twitter:image" content="https://vybrowsbeauty.com/images/SEO.png" />
    <meta property="twitter:image:alt" content="VYBROWS ACADEMY - Premier PMU Training Institute" />

    <!-- Prevent cache during development -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <!-- Preconnect for performance -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com" />
    <link rel="dns-prefetch" href="//fonts.gstatic.com" />
    <link rel="preload" href="/logo.webp" as="image" type="image/webp" />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="alternate icon" href="/favicon.ico" sizes="any" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">

    <!-- Structured Data for Organization/Website Logo -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "VYBROWS ACADEMY | PMU Studio & Academy",
      "alternateName": ["VyBrows Academy", "Vy Brows Beauty", "VyBrowsBeauty", "VYBROWS ACADEMY", "VY BROWS BEAUTY"],
      "url": "https://vybrowsbeauty.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://vybrowsbeauty.com/logo.webp",
        "width": 400,
        "height": 400,
        "contentUrl": "https://vybrowsbeauty.com/logo.webp"
      },
      "image": {
        "@type": "ImageObject",
        "url": "https://vybrowsbeauty.com/images/SEO.png",
        "width": 1200,
        "height": 630,
        "contentUrl": "https://vybrowsbeauty.com/images/SEO.png",
        "caption": "VYBROWS ACADEMY - Premier PMU Training Institute"
      },
      "description": "VYBROWS ACADEMY | #1 PMU Studio & Academy - America's Premier Permanent Makeup Training Institute. Professional PMU Certification, Advanced Microblading Courses & Beauty Academy. Certified instructors, hands-on training, career transformation.",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "US"
      },
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "customer service"
      },
      "sameAs": [
        "https://www.facebook.com/vybrowsbeauty",
        "https://www.instagram.com/vybrowsbeauty"
      ],
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "reviewCount": "150"
      },
      "accreditedBy": {
        "@type": "Organization",
        "name": "Professional Beauty Association"
      },
      "hasCredential": [
        {
          "@type": "EducationalOccupationalCredential",
          "credentialCategory": "Professional Certification",
          "name": "Certified PMU Instructor"
        },
        {
          "@type": "EducationalOccupationalCredential", 
          "credentialCategory": "Safety Certification",
          "name": "Health & Safety Certified Academy"
        }
      ]
    }
    </script>

    <!-- Website Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "VYBROWS ACADEMY | PMU Studio & Academy",
      "url": "https://vybrowsbeauty.com",
      "description": "VYBROWS ACADEMY | #1 PMU Studio & Academy - Professional Permanent Makeup & Beauty Services",
      "publisher": {
        "@type": "Organization",
        "name": "VYBROWS ACADEMY | #1 PMU Studio & Academy",
        "logo": {
          "@type": "ImageObject",
          "url": "https://vybrowsbeauty.com/logo.webp"
        }
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://vybrowsbeauty.com/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>

    <!-- WebPage Schema with Featured Image -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "VYBROWS ACADEMY | #1 PMU Studio & Academy",
      "url": {Astro.url},
      "description": "Leading permanent makeup studio specializing in microblading, PMU services, and natural beauty enhancements. Expert artists, safe techniques, stunning results.",
      "image": {
        "@type": "ImageObject",
        "url": "https://vybrowsbeauty.com/images/SEO.png",
        "width": 1200,
        "height": 630,
        "caption": "VYBROWS ACADEMY - Premier PMU Training Institute"
      },
      "primaryImageOfPage": {
        "@type": "ImageObject",
        "url": "https://vybrowsbeauty.com/images/SEO.png",
        "width": 1200,
        "height": 630
      },
      "breadcrumb": {
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://vybrowsbeauty.com"
          }
        ]
      }
    }
    </script>

    <!-- Site Navigation Schema for Sitelinks -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "itemListElement": [
        {
          "@type": "SiteNavigationElement",
          "position": 1,
          "name": "About Us",
          "description": "Learn about VYBROWS ACADEMY - Expert PMU artists and certified instructors",
          "url": "https://vybrowsbeauty.com/about-us"
        },
        {
          "@type": "SiteNavigationElement",
          "position": 2,
          "name": "Services",
          "description": "Professional Permanent Makeup Services - Microblading, PMU, Lip Blush & More",
          "url": "https://vybrowsbeauty.com/#services"
        },
        {
          "@type": "SiteNavigationElement",
          "position": 3,
          "name": "Training",
          "description": "Professional PMU Training & Certification Courses",
          "url": "https://vybrowsbeauty.com/training"
        },
        {
          "@type": "SiteNavigationElement",
          "position": 4,
          "name": "Contact",
          "description": "Book Your Consultation - Houston Location",
          "url": "https://vybrowsbeauty.com/contact"
        },
        {
          "@type": "SiteNavigationElement",
          "position": 5,
          "name": "News",
          "description": "Latest Beauty Trends & PMU Updates",
          "url": "https://vybrowsbeauty.com/news"
        },
        {
          "@type": "SiteNavigationElement",
          "position": 6,
          "name": "Microblading",
          "description": "Natural Hair-Stroke Eyebrow Technique",
          "url": "https://vybrowsbeauty.com/service/micro-blading"
        }
      ]
    }
    </script>

    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://vybrowsbeauty.com"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Services",
          "item": "https://vybrowsbeauty.com/en/service/pmu-permanent-makeup"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "Training",
          "item": "https://vybrowsbeauty.com/en/training"
        }
      ]
    }
    </script>

    <title>{title}</title>
  </head>
  <body class="min-h-screen transition-colors duration-200 bg-primary" style="">
    <script src="/smooth-scroll.js" defer></script>
    <!-- Header space for fixed header -->
    <div class="h-[88px]"></div> <!-- TopBar height ~40px + Navbar height ~64px -->
    
    <Header />
    <main>
      <slot />
    </main>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  </body>
</html>